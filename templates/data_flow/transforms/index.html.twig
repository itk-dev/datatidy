{% extends 'data_flow/transforms/layout.html.twig' %}
{% trans_default_domain 'data_flow' %}

{% block title %}{{ 'Data flow transforms'|trans }}{% endblock %}

{% block header %}{{ 'Data flow transforms'|trans }}{% endblock %}

{% block content %}
    <h1>{{ data_flow.name }}</h1>

    <div class="row">
        <div class="col-8">
            <iframe id="data-flow-preview" data-src="{{ path('data_flow_transforms_preview', {data_flow: data_flow.id}) }}" src="{{ path('data_flow_transforms_preview', {data_flow: data_flow.id}) }}"></iframe>
        </div>
        <div class="col">
            <table class="transforms">
                <tr class="transform">
                    <td/>
                    <td>
                        <button data-run-flow-to-step="0" class="btn btn-secondary btn-sm">{{ 'First step'|trans }}</button>
                    </td>
                </tr>
                {% for transform in data_flow.transforms %}
                    <tr class="transform">
                        <td class="name">{{ transform.name }}</td>
                        <td>
                            <button data-run-flow-to-step="{{ transform.position + 1 }}" class="btn btn-secondary btn-sm">{{ 'Run to this step'|trans }}</button>
                            <button class="btn btn-secondary btn-sm">{{ 'Edit transform'|trans }}</button>
                        </td>
                    </tr>
                {% endfor %}
            </table>

            <div class="btn-group" role="group">
                <form method="get" action="{{ path('data_flow_transforms_new', {data_flow: data_flow.id}) }}">
                    <select id="new-tranform-transformer" name="transformer" required>
                        <option></option>
                        {% for transformer in transformers %}
                            <option value="{{ transformer.class }}">{{ transformer.name|trans }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" class="btn btn-primary">{{ 'Add transform'|trans }}</button>
                </form>
            </div>
        </div>
    </div>
{% endblock %}
